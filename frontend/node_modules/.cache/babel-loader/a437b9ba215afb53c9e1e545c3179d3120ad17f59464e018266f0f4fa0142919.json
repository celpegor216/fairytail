{"ast":null,"code":"import _slicedToArray from\"C:/Users/Administrator/Desktop/S07P31C209/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useRef,useState}from'react';import{Marker,Popup,useMap,useMapEvent}from'react-leaflet';import{ClickMarkerIcon}from'./CustomMarker';import{useNavigate}from'react-router';import'./ClickMarker.scss';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ClickMarker(_ref){var isClicked=_ref.isClicked,setIsClicked=_ref.setIsClicked,position=_ref.position,setPosition=_ref.setPosition;var navigate=useNavigate();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),place=_useState2[0],setPlace=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),refReady=_useState4[0],setRefReady=_useState4[1];var popupRef=useRef();var map=useMap();useMapEvent('click',function(e){var _e$latlng=e.latlng,lat=_e$latlng.lat,lng=_e$latlng.lng;setPosition({lat:lat,lng:lng});setIsClicked(true);});useEffect(function(){if(refReady&&isClicked){popupRef.openOn(map);axios.get(\"https://nominatim.openstreetmap.org/reverse?lat=\".concat(position.lat,\"&lon=\").concat(position.lng,\"&format=json&zoom=10\")).then(function(response){setPlace(response.data.display_name);map.flyTo(position,map.getZoom());});}},[refReady,map,position]);return/*#__PURE__*/_jsx(Marker,{position:[position.lat,position.lng],icon:ClickMarkerIcon,children:/*#__PURE__*/_jsx(Popup,{ref:function ref(r){popupRef=r;setRefReady(true);},children:/*#__PURE__*/_jsxs(\"div\",{className:\"clickmarker-popup\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"clickmarker-popup-title\",children:\"\\uC5EC\\uAE30\\uB294\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"clickmarker-popup-content\",children:[place?place:'알려지지 않은 곳',\" \\uC785\\uB2C8\\uB2E4.\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn clickmarker-popup-btn\",onClick:function onClick(){return navigate('/vr',{state:{position:position}});},children:\"\\uBCF4\\uB7EC\\uAC00\\uAE30\"})]})})});}export default ClickMarker;","map":{"version":3,"names":["useEffect","useRef","useState","Marker","Popup","useMap","useMapEvent","ClickMarkerIcon","useNavigate","axios","ClickMarker","isClicked","setIsClicked","position","setPosition","navigate","place","setPlace","refReady","setRefReady","popupRef","map","e","latlng","lat","lng","openOn","get","then","response","data","display_name","flyTo","getZoom","r","state"],"sources":["C:/Users/Administrator/Desktop/S07P31C209/frontend/src/components/map/ClickMarker.jsx"],"sourcesContent":["import {useEffect, useRef, useState} from 'react';\r\nimport {Marker, Popup, useMap, useMapEvent} from 'react-leaflet';\r\nimport {ClickMarkerIcon} from './CustomMarker';\r\nimport {useNavigate} from 'react-router';\r\nimport './ClickMarker.scss';\r\nimport axios from 'axios';\r\n\r\nfunction ClickMarker({isClicked, setIsClicked, position, setPosition}) {\r\n  const navigate = useNavigate();\r\n\r\n  const [place, setPlace] = useState('');\r\n\r\n  const [refReady, setRefReady] = useState(false);\r\n  let popupRef = useRef();\r\n\r\n  const map = useMap();\r\n\r\n  useMapEvent('click', e => {\r\n    const {lat, lng} = e.latlng;\r\n    setPosition({lat: lat, lng: lng});\r\n    setIsClicked(true);\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (refReady && isClicked) {\r\n      popupRef.openOn(map);\r\n\r\n      axios\r\n        .get(\r\n          `https://nominatim.openstreetmap.org/reverse?lat=${position.lat}&lon=${position.lng}&format=json&zoom=10`,\r\n        )\r\n        .then(response => {\r\n          setPlace(response.data.display_name);\r\n          map.flyTo(position, map.getZoom());\r\n        });\r\n    }\r\n  }, [refReady, map, position]);\r\n\r\n  return (\r\n    <Marker position={[position.lat, position.lng]} icon={ClickMarkerIcon}>\r\n      <Popup\r\n        ref={r => {\r\n          popupRef = r;\r\n          setRefReady(true);\r\n        }}>\r\n        <div className=\"clickmarker-popup\">\r\n          <div className=\"clickmarker-popup-title\">여기는</div>\r\n          <div className=\"clickmarker-popup-content\">\r\n            {place ? place : '알려지지 않은 곳'} 입니다.\r\n          </div>\r\n          <button\r\n            className=\"btn clickmarker-popup-btn\"\r\n            onClick={() => navigate('/vr', {state: {position: position}})}>\r\n            보러가기\r\n          </button>\r\n        </div>\r\n      </Popup>\r\n    </Marker>\r\n  );\r\n}\r\n\r\nexport default ClickMarker;\r\n"],"mappings":"wIAAA,OAAQA,SAAS,CAAEC,MAAM,CAAEC,QAAQ,KAAO,OAAO,CACjD,OAAQC,MAAM,CAAEC,KAAK,CAAEC,MAAM,CAAEC,WAAW,KAAO,eAAe,CAChE,OAAQC,eAAe,KAAO,gBAAgB,CAC9C,OAAQC,WAAW,KAAO,cAAc,CACxC,MAAO,oBAAoB,CAC3B,MAAOC,MAAK,KAAM,OAAO,CAAC,wFAE1B,QAASC,YAAW,MAAmD,IAAjDC,UAAS,MAATA,SAAS,CAAEC,YAAY,MAAZA,YAAY,CAAEC,QAAQ,MAARA,QAAQ,CAAEC,WAAW,MAAXA,WAAW,CAClE,GAAMC,SAAQ,CAAGP,WAAW,EAAE,CAE9B,cAA0BN,QAAQ,CAAC,EAAE,CAAC,wCAA/Bc,KAAK,eAAEC,QAAQ,eAEtB,eAAgCf,QAAQ,CAAC,KAAK,CAAC,yCAAxCgB,QAAQ,eAAEC,WAAW,eAC5B,GAAIC,SAAQ,CAAGnB,MAAM,EAAE,CAEvB,GAAMoB,IAAG,CAAGhB,MAAM,EAAE,CAEpBC,WAAW,CAAC,OAAO,CAAE,SAAAgB,CAAC,CAAI,CACxB,cAAmBA,CAAC,CAACC,MAAM,CAApBC,GAAG,WAAHA,GAAG,CAAEC,GAAG,WAAHA,GAAG,CACfX,WAAW,CAAC,CAACU,GAAG,CAAEA,GAAG,CAAEC,GAAG,CAAEA,GAAG,CAAC,CAAC,CACjCb,YAAY,CAAC,IAAI,CAAC,CACpB,CAAC,CAAC,CAEFZ,SAAS,CAAC,UAAM,CACd,GAAIkB,QAAQ,EAAIP,SAAS,CAAE,CACzBS,QAAQ,CAACM,MAAM,CAACL,GAAG,CAAC,CAEpBZ,KAAK,CACFkB,GAAG,2DACiDd,QAAQ,CAACW,GAAG,iBAAQX,QAAQ,CAACY,GAAG,yBACpF,CACAG,IAAI,CAAC,SAAAC,QAAQ,CAAI,CAChBZ,QAAQ,CAACY,QAAQ,CAACC,IAAI,CAACC,YAAY,CAAC,CACpCV,GAAG,CAACW,KAAK,CAACnB,QAAQ,CAAEQ,GAAG,CAACY,OAAO,EAAE,CAAC,CACpC,CAAC,CAAC,CACN,CACF,CAAC,CAAE,CAACf,QAAQ,CAAEG,GAAG,CAAER,QAAQ,CAAC,CAAC,CAE7B,mBACE,KAAC,MAAM,EAAC,QAAQ,CAAE,CAACA,QAAQ,CAACW,GAAG,CAAEX,QAAQ,CAACY,GAAG,CAAE,CAAC,IAAI,CAAElB,eAAgB,uBACpE,KAAC,KAAK,EACJ,GAAG,CAAE,aAAA2B,CAAC,CAAI,CACRd,QAAQ,CAAGc,CAAC,CACZf,WAAW,CAAC,IAAI,CAAC,CACnB,CAAE,uBACF,aAAK,SAAS,CAAC,mBAAmB,wBAChC,YAAK,SAAS,CAAC,yBAAyB,gCAAU,cAClD,aAAK,SAAS,CAAC,2BAA2B,WACvCH,KAAK,CAAGA,KAAK,CAAG,WAAW,0BACxB,cACN,eACE,SAAS,CAAC,2BAA2B,CACrC,OAAO,CAAE,yBAAMD,SAAQ,CAAC,KAAK,CAAE,CAACoB,KAAK,CAAE,CAACtB,QAAQ,CAAEA,QAAQ,CAAC,CAAC,CAAC,EAAC,sCAEvD,GACL,EACA,EACD,CAEb,CAEA,cAAeH,YAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}