{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\S07P31C209\\\\frontend\\\\src\\\\screens\\\\MessageDetail.tsx\",\n  _s = $RefreshSig$();\n// ** 메시지 상세\nimport { useState, useRef, useEffect } from 'react';\nimport { useNavigate, useParams } from 'react-router';\nimport '@screens/MessageDetail.scss';\nimport Content from '@messageDetail/Content';\nimport Like from '@messageDetail/Like';\nimport MoreMenu from '@common/MoreMenu';\nimport MoveToBack from '@common/MoveToBack';\nimport '@screens/MessageDetail.scss';\nimport { intMessageId, convStringType } from '@/components/common/commonFunc';\nimport { currentUser } from '@common/commonFunc';\nimport { ReactComponent as EllipsisVertical } from '@images/ellipsisVertical.svg';\nimport { notFound, intro } from '@apis/router';\nimport { getMesssage } from '@apis/messageDetail/detailFunc';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction MessageDetail() {\n  _s();\n  // 풍선 저장 관련\n  const messageDetailRef = useRef(null);\n\n  // 전달 받은 messageId가 숫자가 아니라면 notfound로 이동\n  const navigate = useNavigate();\n  const params = useParams();\n  const messageId = intMessageId(params.id);\n  const type = convStringType(params.type);\n\n  // 현재 사용자 정보\n  const userId = currentUser();\n\n  // 서버 통신으로 게시글 정보 가져오기\n  const [data, setData] = useState(null);\n  const getDetailMessage = () => {\n    getMesssage(type, {\n      postId: messageId,\n      userId\n    }).then(res => {\n      console.log(res);\n      if (res.message === 'SUCCESS') {\n        setData(() => res.data);\n      } else {\n        // 실패했을 경우 404로 이동\n        navigate(notFound());\n      }\n    }).catch(error => navigate(notFound()));\n  };\n  // if (type === 'text') {\n  //   getTextMesssage(type, messageId).then((res: textDetailResponse) => {\n  //     if (res.message === 'SUCCESS') {\n  //       setData(prev => {\n  //         return {...prev, ...res.data};\n  //       });\n  //     } else {\n  //       // 실패했을 경우 404로 이동\n  //       navigate(notFound());\n  //     }\n  //   });\n  // } else if (type === 'img') {\n  //   getImgMesssage(type, {postId: messageId, userId}).then(\n  //     (res: imgDetailResponse) => {\n  //       if (res.message === 'SUCCESS') {\n  //         setData(prev => {\n  //           return {...prev, ...res.data};\n  //         });\n  //       } else {\n  //         // 실패했을 경우 404로 이동\n  //         navigate(notFound());\n  //       }\n  //     },\n  //   );\n  // } else {\n  //   navigate(notFound());\n  // }\n  // };\n  // 현재 사용자가 작성한 게시글인지 확인\n  const isMine = () => (data === null || data === void 0 ? void 0 : data.userId) === userId;\n  useEffect(() => {\n    if (messageId === -1) {\n      navigate(notFound());\n    } else if (userId === -1) {\n      navigate(intro());\n    } else if (type) {\n      getDetailMessage();\n    }\n  }, []);\n\n  // 비공개 글일 때 작성자가 자신이 아니면 404 페이지로 이동\n  useEffect(() => {\n    if (!isMine() && data !== null && data !== void 0 && data.status) {\n      navigate(notFound());\n    }\n  }, [data]);\n  useEffect(() => {\n    setNewStatus(() => data === null || data === void 0 ? void 0 : data.status);\n  }, [data]);\n\n  // useEffect(() => {\n\n  //   if (isText(type)) {\n  //     if (!isMine() && textData?.status) {\n  //       navigate(notFound())\n  //     } else {\n  //       setTextData(() => textData)\n  //     }\n  //   } else {\n  //     if (!isMine() && imgData?.status) {\n  //       navigate(notFound())\n  //     } else {\n  //       setImgData(() => imgData)\n  //     }\n  //   }\n  //   // if (!isMine() && (textData?.status || imgData?.status)) {\n  //   //   navigate(notFound());\n  //   // }\n  //   // setData(() => data);\n  //   // setNewStatus(data?.status);\n  // }, [data]);\n\n  // 메뉴 표시 여부\n  const [more, setMore] = useState(false);\n  const hiddenMenu = () => {\n    if (more) setMore(false);\n  };\n  const showMenu = () => setMore(!more);\n\n  // 공개 여부 변경 대비\n  const [newStatus, setNewStatus] = useState(data === null || data === void 0 ? void 0 : data.status);\n  // content에 들어갈 내용\n  // const detailContent = () => {\n  //   if (isText(type)) {\n  //     return textData?.content;\n  //   } else {\n  //     return imgData?.url ? `https://${imgData?.url}` : '';\n  //   }\n  // };\n\n  const dayType = () => data === null || data === void 0 ? void 0 : data.dayType;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: data ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `screen background${dayType()}`,\n      ref: messageDetailRef,\n      onClick: hiddenMenu,\n      children: /*#__PURE__*/_jsxDEV(\"main\", {\n        id: \"container\",\n        children: [/*#__PURE__*/_jsxDEV(\"section\", {\n          \"data-html2canvas-ignore\": \"true\",\n          className: \"ignore\",\n          children: [/*#__PURE__*/_jsxDEV(MoveToBack, {\n            path: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"message-detail-nav-more\",\n            onClick: showMenu,\n            children: /*#__PURE__*/_jsxDEV(EllipsisVertical, {\n              width: \"32\",\n              height: \"32\",\n              fill: \"white\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(MoreMenu, {\n            open: more,\n            isMine: isMine(),\n            detail: messageDetailRef,\n            messageId: messageId,\n            type: type\n            // content={data?.url || data?.content}\n            ,\n            close: hiddenMenu,\n            data: data\n            // setData={setData}\n            ,\n            status: newStatus,\n            setStatus: setNewStatus\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"container\",\n          children: [/*#__PURE__*/_jsxDEV(Content, {\n            data: data\n            // title={textData?.title || imgData?.title || ''}\n            // content={detailContent()}\n            // type={data.type}\n            // date={modifiedDate()}\n            ,\n            status: newStatus\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Like, {\n            data: data,\n            type: type,\n            userId: userId\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 9\n    }, this) : null\n  }, void 0, false);\n}\n_s(MessageDetail, \"8lPI1+SfB/ZmvO2k2DyMlwYfzZs=\", false, function () {\n  return [useNavigate, useParams];\n});\n_c = MessageDetail;\nexport default MessageDetail;\nvar _c;\n$RefreshReg$(_c, \"MessageDetail\");","map":{"version":3,"names":["useState","useRef","useEffect","useNavigate","useParams","Content","Like","MoreMenu","MoveToBack","intMessageId","convStringType","currentUser","ReactComponent","EllipsisVertical","notFound","intro","getMesssage","MessageDetail","messageDetailRef","navigate","params","messageId","id","type","userId","data","setData","getDetailMessage","postId","then","res","console","log","message","catch","error","isMine","status","setNewStatus","more","setMore","hiddenMenu","showMenu","newStatus","dayType"],"sources":["C:/Users/Administrator/Desktop/S07P31C209/frontend/src/screens/MessageDetail.tsx"],"sourcesContent":["// ** 메시지 상세\r\nimport {useState, useRef, useEffect} from 'react';\r\nimport {useNavigate, useParams} from 'react-router';\r\n\r\nimport '@screens/MessageDetail.scss';\r\nimport Content from '@messageDetail/Content';\r\nimport Like from '@messageDetail/Like';\r\nimport MoreMenu from '@common/MoreMenu';\r\nimport MoveToBack from '@common/MoveToBack';\r\nimport '@screens/MessageDetail.scss';\r\nimport {intMessageId, convStringType} from '@/components/common/commonFunc';\r\nimport {currentUser} from '@common/commonFunc';\r\nimport {dataType} from '@apis/messageDetail/detailInterface';\r\nimport {ReactComponent as EllipsisVertical} from '@images/ellipsisVertical.svg';\r\nimport {notFound, intro} from '@apis/router';\r\nimport {getMesssage} from '@apis/messageDetail/detailFunc';\r\n\r\nfunction MessageDetail() {\r\n  // 풍선 저장 관련\r\n  const messageDetailRef = useRef(null!);\r\n\r\n  // 전달 받은 messageId가 숫자가 아니라면 notfound로 이동\r\n  const navigate = useNavigate();\r\n  const params = useParams();\r\n  const messageId = intMessageId(params.id);\r\n  const type = convStringType(params.type);\r\n\r\n  // 현재 사용자 정보\r\n  const userId = currentUser();\r\n\r\n  // 서버 통신으로 게시글 정보 가져오기\r\n  const [data, setData] = useState<dataType>(null!);\r\n  const getDetailMessage = () => {\r\n    getMesssage(type, {postId: messageId, userId})\r\n      .then((res: any) => {\r\n        console.log(res);\r\n        if (res.message === 'SUCCESS') {\r\n          setData(() => res.data);\r\n        } else {\r\n          // 실패했을 경우 404로 이동\r\n          navigate(notFound());\r\n        }\r\n      })\r\n      .catch((error: any) => navigate(notFound()));\r\n  };\r\n  // if (type === 'text') {\r\n  //   getTextMesssage(type, messageId).then((res: textDetailResponse) => {\r\n  //     if (res.message === 'SUCCESS') {\r\n  //       setData(prev => {\r\n  //         return {...prev, ...res.data};\r\n  //       });\r\n  //     } else {\r\n  //       // 실패했을 경우 404로 이동\r\n  //       navigate(notFound());\r\n  //     }\r\n  //   });\r\n  // } else if (type === 'img') {\r\n  //   getImgMesssage(type, {postId: messageId, userId}).then(\r\n  //     (res: imgDetailResponse) => {\r\n  //       if (res.message === 'SUCCESS') {\r\n  //         setData(prev => {\r\n  //           return {...prev, ...res.data};\r\n  //         });\r\n  //       } else {\r\n  //         // 실패했을 경우 404로 이동\r\n  //         navigate(notFound());\r\n  //       }\r\n  //     },\r\n  //   );\r\n  // } else {\r\n  //   navigate(notFound());\r\n  // }\r\n  // };\r\n  // 현재 사용자가 작성한 게시글인지 확인\r\n  const isMine = () => data?.userId === userId;\r\n\r\n  useEffect(() => {\r\n    if (messageId === -1) {\r\n      navigate(notFound());\r\n    } else if (userId === -1) {\r\n      navigate(intro());\r\n    } else if (type) {\r\n      getDetailMessage();\r\n    }\r\n  }, []);\r\n\r\n  // 비공개 글일 때 작성자가 자신이 아니면 404 페이지로 이동\r\n  useEffect(() => {\r\n    if (!isMine() && data?.status) {\r\n      navigate(notFound());\r\n    }\r\n  }, [data]);\r\n\r\n  useEffect(() => {\r\n    setNewStatus(() => data?.status);\r\n  }, [data]);\r\n\r\n  // useEffect(() => {\r\n\r\n  //   if (isText(type)) {\r\n  //     if (!isMine() && textData?.status) {\r\n  //       navigate(notFound())\r\n  //     } else {\r\n  //       setTextData(() => textData)\r\n  //     }\r\n  //   } else {\r\n  //     if (!isMine() && imgData?.status) {\r\n  //       navigate(notFound())\r\n  //     } else {\r\n  //       setImgData(() => imgData)\r\n  //     }\r\n  //   }\r\n  //   // if (!isMine() && (textData?.status || imgData?.status)) {\r\n  //   //   navigate(notFound());\r\n  //   // }\r\n  //   // setData(() => data);\r\n  //   // setNewStatus(data?.status);\r\n  // }, [data]);\r\n\r\n  // 메뉴 표시 여부\r\n  const [more, setMore] = useState(false);\r\n\r\n  const hiddenMenu = () => {\r\n    if (more) setMore(false);\r\n  };\r\n\r\n  const showMenu = () => setMore(!more);\r\n\r\n  // 공개 여부 변경 대비\r\n  const [newStatus, setNewStatus] = useState(data?.status);\r\n  // content에 들어갈 내용\r\n  // const detailContent = () => {\r\n  //   if (isText(type)) {\r\n  //     return textData?.content;\r\n  //   } else {\r\n  //     return imgData?.url ? `https://${imgData?.url}` : '';\r\n  //   }\r\n  // };\r\n\r\n  const dayType = () => data?.dayType;\r\n\r\n  return (\r\n    <>\r\n      {data ? (\r\n        <div\r\n          className={`screen background${dayType()}`}\r\n          ref={messageDetailRef}\r\n          onClick={hiddenMenu}>\r\n          <main id=\"container\">\r\n            <section data-html2canvas-ignore=\"true\" className=\"ignore\">\r\n              <MoveToBack path=\"\" />\r\n              <div id=\"message-detail-nav-more\" onClick={showMenu}>\r\n                <EllipsisVertical width=\"32\" height=\"32\" fill=\"white\" />\r\n              </div>\r\n              <MoreMenu\r\n                open={more}\r\n                isMine={isMine()}\r\n                detail={messageDetailRef}\r\n                messageId={messageId}\r\n                type={type}\r\n                // content={data?.url || data?.content}\r\n                close={hiddenMenu}\r\n                data={data}\r\n                // setData={setData}\r\n                status={newStatus}\r\n                setStatus={setNewStatus}\r\n              />\r\n            </section>\r\n            <section className=\"container\">\r\n              <Content\r\n                data={data}\r\n                // title={textData?.title || imgData?.title || ''}\r\n                // content={detailContent()}\r\n                // type={data.type}\r\n                // date={modifiedDate()}\r\n                status={newStatus}\r\n              />\r\n              <Like data={data} type={type} userId={userId} />\r\n            </section>\r\n          </main>\r\n        </div>\r\n      ) : null}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MessageDetail;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}