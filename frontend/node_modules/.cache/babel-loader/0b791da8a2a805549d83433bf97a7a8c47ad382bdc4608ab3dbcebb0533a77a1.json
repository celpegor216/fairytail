{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\S07P31C209\\\\frontend\\\\src\\\\apis\\\\notifications\\\\foregroundMessaging.tsx\",\n  _s = $RefreshSig$();\nimport { getMessaging, onMessage } from 'firebase/messaging';\nimport app from '@apis/notifications/firebaseConfig';\nimport { returnTrue } from '@/components/common/commonFunc';\nimport MyNotification from '@individual/MyNotification';\nimport { useEffect, useState } from 'react';\nimport { returnFalse } from '@common/commonFunc';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction InitMessage() {\n  _s();\n  const messaging = getMessaging(app);\n  const initialInfo = {\n    id: 0,\n    title: '',\n    emoji: 0\n  };\n  const [info, setInfo] = useState(initialInfo);\n  const [open, setOpen] = useState(false);\n  const changeOpenState = () => {\n    if (open) {\n      setInterval(() => {\n        setOpen(returnFalse);\n      }, 5000);\n    }\n  };\n  onMessage(messaging, payload => {\n    var _payload$notification, _payload$notification2;\n    if ((_payload$notification = payload.notification) !== null && _payload$notification !== void 0 && _payload$notification.body && (_payload$notification2 = payload.notification) !== null && _payload$notification2 !== void 0 && _payload$notification2.title) {\n      var _payload$notification3, _payload$notification4;\n      const body = JSON.parse((_payload$notification3 = payload.notification) === null || _payload$notification3 === void 0 ? void 0 : _payload$notification3.body);\n      const newInfo = {\n        id: body === null || body === void 0 ? void 0 : body.post_id,\n        emoji: body === null || body === void 0 ? void 0 : body.emoji_no,\n        title: (_payload$notification4 = payload.notification) === null || _payload$notification4 === void 0 ? void 0 : _payload$notification4.title\n      };\n      setInfo(newInfo);\n    }\n  });\n  useEffect(() => {\n    if (info !== initialInfo) {\n      setOpen(returnTrue);\n    }\n  }, [info]);\n  useEffect(() => changeOpenState, [open]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: open ? /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"foreground\",\n      children: /*#__PURE__*/_jsxDEV(MyNotification, {\n        item: info\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 9\n    }, this) : null\n  }, void 0, false);\n}\n_s(InitMessage, \"2VokHioHmU4DZOjmT68se8EF4Js=\");\n_c = InitMessage;\nexport default InitMessage;\nvar _c;\n$RefreshReg$(_c, \"InitMessage\");","map":{"version":3,"names":["getMessaging","onMessage","app","returnTrue","MyNotification","useEffect","useState","returnFalse","InitMessage","messaging","initialInfo","id","title","emoji","info","setInfo","open","setOpen","changeOpenState","setInterval","payload","notification","body","JSON","parse","newInfo","post_id","emoji_no"],"sources":["C:/Users/Administrator/Desktop/S07P31C209/frontend/src/apis/notifications/foregroundMessaging.tsx"],"sourcesContent":["import {getMessaging, onMessage} from 'firebase/messaging';\r\nimport app from '@apis/notifications/firebaseConfig';\r\nimport {returnTrue} from '@/components/common/commonFunc';\r\nimport MyNotification from '@individual/MyNotification';\r\nimport {useEffect, useState} from 'react';\r\nimport {returnFalse} from '@common/commonFunc';\r\n\r\nfunction InitMessage() {\r\n  const messaging = getMessaging(app);\r\n  const initialInfo = {id: 0, title: '', emoji: 0};\r\n  const [info, setInfo] = useState(initialInfo);\r\n  const [open, setOpen] = useState(false);\r\n  const changeOpenState = () => {\r\n    if (open) {\r\n      setInterval(() => {\r\n        setOpen(returnFalse);\r\n      }, 5000);\r\n    }\r\n  };\r\n\r\n  onMessage(messaging, payload => {\r\n    if (payload.notification?.body && payload.notification?.title) {\r\n      const body = JSON.parse(payload.notification?.body);\r\n      const newInfo = {\r\n        id: body?.post_id,\r\n        emoji: body?.emoji_no,\r\n        title: payload.notification?.title,\r\n      };\r\n      setInfo(newInfo);\r\n    }\r\n  });\r\n  useEffect(() => {\r\n    if (info !== initialInfo) {\r\n      setOpen(returnTrue);\r\n    }\r\n  }, [info]);\r\n\r\n  useEffect(() => changeOpenState, [open]);\r\n\r\n  return (\r\n    <>\r\n      {open ? (\r\n        <div id=\"foreground\">\r\n          <MyNotification item={info} />\r\n        </div>\r\n      ) : null}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default InitMessage;\r\n"],"mappings":";;AAAA,SAAQA,YAAY,EAAEC,SAAS,QAAO,oBAAoB;AAC1D,OAAOC,GAAG,MAAM,oCAAoC;AACpD,SAAQC,UAAU,QAAO,gCAAgC;AACzD,OAAOC,cAAc,MAAM,4BAA4B;AACvD,SAAQC,SAAS,EAAEC,QAAQ,QAAO,OAAO;AACzC,SAAQC,WAAW,QAAO,oBAAoB;AAAC;AAAA;AAE/C,SAASC,WAAW,GAAG;EAAA;EACrB,MAAMC,SAAS,GAAGT,YAAY,CAACE,GAAG,CAAC;EACnC,MAAMQ,WAAW,GAAG;IAACC,EAAE,EAAE,CAAC;IAAEC,KAAK,EAAE,EAAE;IAAEC,KAAK,EAAE;EAAC,CAAC;EAChD,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGT,QAAQ,CAACI,WAAW,CAAC;EAC7C,MAAM,CAACM,IAAI,EAAEC,OAAO,CAAC,GAAGX,QAAQ,CAAC,KAAK,CAAC;EACvC,MAAMY,eAAe,GAAG,MAAM;IAC5B,IAAIF,IAAI,EAAE;MACRG,WAAW,CAAC,MAAM;QAChBF,OAAO,CAACV,WAAW,CAAC;MACtB,CAAC,EAAE,IAAI,CAAC;IACV;EACF,CAAC;EAEDN,SAAS,CAACQ,SAAS,EAAEW,OAAO,IAAI;IAAA;IAC9B,IAAI,yBAAAA,OAAO,CAACC,YAAY,kDAApB,sBAAsBC,IAAI,8BAAIF,OAAO,CAACC,YAAY,mDAApB,uBAAsBT,KAAK,EAAE;MAAA;MAC7D,MAAMU,IAAI,GAAGC,IAAI,CAACC,KAAK,2BAACJ,OAAO,CAACC,YAAY,2DAApB,uBAAsBC,IAAI,CAAC;MACnD,MAAMG,OAAO,GAAG;QACdd,EAAE,EAAEW,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEI,OAAO;QACjBb,KAAK,EAAES,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEK,QAAQ;QACrBf,KAAK,4BAAEQ,OAAO,CAACC,YAAY,2DAApB,uBAAsBT;MAC/B,CAAC;MACDG,OAAO,CAACU,OAAO,CAAC;IAClB;EACF,CAAC,CAAC;EACFpB,SAAS,CAAC,MAAM;IACd,IAAIS,IAAI,KAAKJ,WAAW,EAAE;MACxBO,OAAO,CAACd,UAAU,CAAC;IACrB;EACF,CAAC,EAAE,CAACW,IAAI,CAAC,CAAC;EAEVT,SAAS,CAAC,MAAMa,eAAe,EAAE,CAACF,IAAI,CAAC,CAAC;EAExC,oBACE;IAAA,UACGA,IAAI,gBACH;MAAK,EAAE,EAAC,YAAY;MAAA,uBAClB,QAAC,cAAc;QAAC,IAAI,EAAEF;MAAK;QAAA;QAAA;QAAA;MAAA;IAAG;MAAA;MAAA;MAAA;IAAA,QAC1B,GACJ;EAAI,iBACP;AAEP;AAAC,GAzCQN,WAAW;AAAA,KAAXA,WAAW;AA2CpB,eAAeA,WAAW;AAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}