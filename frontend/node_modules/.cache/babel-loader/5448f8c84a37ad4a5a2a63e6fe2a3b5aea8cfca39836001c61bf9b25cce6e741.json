{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Administrator/Desktop/S07P31C209/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Administrator/Desktop/S07P31C209/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Administrator/Desktop/S07P31C209/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{MapContainer,TileLayer,Marker,ZoomControl,useMap}from'react-leaflet';import'leaflet/dist/leaflet.css';import{CustomMarkerIcon}from'@map/CustomMarker';import'./Map.scss';import ClickMarker from'@map/ClickMarker';import{useEffect,useState}from'react';import shuffle from'@images/shuffle.svg';import MoveToBack from'@common/MoveToBack';import{useRecoilState}from'recoil';import{loadingState}from'@apis/Recoil';import InitMessage from'@/apis/notifications/foregroundMessaging';import{getMessageMap}from'@apis/map';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function generateRandomFloat(min,max){return Math.random()*(max-min)+min;}function SetCenter(_ref){var center=_ref.center;var map=useMap();useEffect(function(){map.setView(center);},[center]);return null;}function Map(){// recoil\nvar _useRecoilState=useRecoilState(loadingState),_useRecoilState2=_slicedToArray(_useRecoilState,2),isLoading=_useRecoilState2[0],setIsLoading=_useRecoilState2[1];setIsLoading(true);// 클릭 시 팝업 표시, 해당 위치 좌표값\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),isClicked=_useState2[0],setIsClicked=_useState2[1];var _useState3=useState({lat:-999,lng:-999}),_useState4=_slicedToArray(_useState3,2),position=_useState4[0],setPosition=_useState4[1];var _useState5=useState({lat:0,lng:0}),_useState6=_slicedToArray(_useState5,2),center=_useState6[0],setCenter=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),data=_useState8[0],setData=_useState8[1];useEffect(function(){// 현재 위치 받아오기\nif(navigator.geolocation){navigator.geolocation.getCurrentPosition(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(pos){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setCenter({lat:pos.coords.latitude,lng:pos.coords.longitude});case 1:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());}// 서버에서 데이터 받아오기\nfor(var i=0;i<4;i++){getMessageMap(i).then(function(res){setData(function(prev){return prev.concat(res.data);});}).catch(function(err){console.log(err);});}},[]);// 받은 데이터 화면에 뿌리기\nvar Markers=function Markers(){var markers=data.map(function(position,index){return/*#__PURE__*/_jsx(Marker,{position:position,icon:CustomMarkerIcon},index);});return markers;};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(InitMessage,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"screen\",children:[/*#__PURE__*/_jsx(MoveToBack,{path:\"/main\",color:\"black\"}),/*#__PURE__*/_jsx(\"div\",{className:\"map-random\",onClick:function onClick(){setPosition({lat:generateRandomFloat(-90,90),lng:generateRandomFloat(-180,180)});setIsClicked(true);},children:/*#__PURE__*/_jsx(\"img\",{src:shuffle,alt:\"\\uB79C\\uB364 \\uC704\\uCE58 \\uC120\\uC815 \\uBC84\\uD2BC\"})}),/*#__PURE__*/_jsxs(MapContainer,{zoomControl:false,maxBounds:[[-90,-180],[90,180]],minZoom:2,style:{width:'100%',height:'100%'},center:center,zoom:14,scrollWheelZoom:true,children:[/*#__PURE__*/_jsx(TileLayer,{attribution:\"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"}),data?Markers():null,/*#__PURE__*/_jsx(ClickMarker,{isClicked:isClicked,setIsClicked:setIsClicked,position:position,setPosition:setPosition}),/*#__PURE__*/_jsx(ZoomControl,{position:\"bottomright\"}),/*#__PURE__*/_jsx(SetCenter,{center:center})]})]})]});}export default Map;","map":{"version":3,"names":["MapContainer","TileLayer","Marker","ZoomControl","useMap","CustomMarkerIcon","ClickMarker","useEffect","useState","shuffle","MoveToBack","useRecoilState","loadingState","InitMessage","getMessageMap","generateRandomFloat","min","max","Math","random","SetCenter","center","map","setView","Map","isLoading","setIsLoading","isClicked","setIsClicked","lat","lng","position","setPosition","setCenter","data","setData","navigator","geolocation","getCurrentPosition","pos","coords","latitude","longitude","i","then","res","prev","concat","catch","err","console","log","Markers","markers","index","width","height"],"sources":["C:/Users/Administrator/Desktop/S07P31C209/frontend/src/screens/Map.jsx"],"sourcesContent":["import {\r\n  MapContainer,\r\n  TileLayer,\r\n  Marker,\r\n  ZoomControl,\r\n  useMap,\r\n} from 'react-leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport {CustomMarkerIcon} from '@map/CustomMarker';\r\nimport './Map.scss';\r\nimport ClickMarker from '@map/ClickMarker';\r\nimport {useEffect, useState} from 'react';\r\nimport shuffle from '@images/shuffle.svg';\r\nimport MoveToBack from '@common/MoveToBack';\r\nimport {useRecoilState} from 'recoil';\r\nimport {loadingState} from '@apis/Recoil';\r\nimport InitMessage from '@/apis/notifications/foregroundMessaging';\r\nimport {getMessageMap} from '@apis/map';\r\n\r\nfunction generateRandomFloat(min, max) {\r\n  return Math.random() * (max - min) + min;\r\n}\r\n\r\nfunction SetCenter({center}) {\r\n  const map = useMap();\r\n\r\n  useEffect(() => {\r\n    map.setView(center);\r\n  }, [center]);\r\n\r\n  return null;\r\n}\r\n\r\nfunction Map() {\r\n  // recoil\r\n  const [isLoading, setIsLoading] = useRecoilState(loadingState);\r\n  setIsLoading(true);\r\n\r\n  // 클릭 시 팝업 표시, 해당 위치 좌표값\r\n  const [isClicked, setIsClicked] = useState(false);\r\n  const [position, setPosition] = useState({lat: -999, lng: -999});\r\n\r\n  const [center, setCenter] = useState({lat: 0, lng: 0});\r\n  const [data, setData] = useState([]);\r\n\r\n  useEffect(() => {\r\n    // 현재 위치 받아오기\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition(async pos => {\r\n        setCenter({\r\n          lat: pos.coords.latitude,\r\n          lng: pos.coords.longitude,\r\n        });\r\n      });\r\n    }\r\n\r\n    // 서버에서 데이터 받아오기\r\n    for (let i = 0; i < 4; i++) {\r\n      getMessageMap(i)\r\n        .then(res => {\r\n          setData(prev => prev.concat(res.data));\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n    }\r\n  }, []);\r\n\r\n  // 받은 데이터 화면에 뿌리기\r\n  const Markers = () => {\r\n    const markers = data.map((position, index) => {\r\n      return <Marker key={index} position={position} icon={CustomMarkerIcon} />;\r\n    });\r\n    return markers;\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <InitMessage />\r\n      <div className=\"screen\">\r\n        <MoveToBack path=\"/main\" color=\"black\" />\r\n        <div\r\n          className=\"map-random\"\r\n          onClick={() => {\r\n            setPosition({\r\n              lat: generateRandomFloat(-90, 90),\r\n              lng: generateRandomFloat(-180, 180),\r\n            });\r\n            setIsClicked(true);\r\n          }}>\r\n          <img src={shuffle} alt=\"랜덤 위치 선정 버튼\" />\r\n        </div>\r\n\r\n        <MapContainer\r\n          zoomControl={false}\r\n          maxBounds={[\r\n            [-90, -180],\r\n            [90, 180],\r\n          ]}\r\n          minZoom={2}\r\n          style={{width: '100%', height: '100%'}}\r\n          center={center}\r\n          zoom={14}\r\n          scrollWheelZoom={true}>\r\n          <TileLayer\r\n            attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n            url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n          />\r\n          {data ? Markers() : null}\r\n          <ClickMarker\r\n            isClicked={isClicked}\r\n            setIsClicked={setIsClicked}\r\n            position={position}\r\n            setPosition={setPosition}\r\n          />\r\n          <ZoomControl position=\"bottomright\" />\r\n          <SetCenter center={center} />\r\n        </MapContainer>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Map;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}