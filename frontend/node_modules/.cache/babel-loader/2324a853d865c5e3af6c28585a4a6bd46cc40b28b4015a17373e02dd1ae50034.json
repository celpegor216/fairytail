{"ast":null,"code":"import _slicedToArray from\"C:/Users/Administrator/Desktop/S07P31C209/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{getMessaging,onMessage}from'firebase/messaging';import app from'@apis/notifications/firebaseConfig';import{returnTrue}from'@/components/common/commonFunc';import MyNotification from'@individual/MyNotification';import{useEffect,useState}from'react';import{returnFalse}from'@common/commonFunc';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function InitMessage(){var messaging=getMessaging(app);var initialInfo={id:0,title:'',emoji:0};var _useState=useState(initialInfo),_useState2=_slicedToArray(_useState,2),info=_useState2[0],setInfo=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),open=_useState4[0],setOpen=_useState4[1];var changeOpenState=function changeOpenState(){if(open){setInterval(function(){setOpen(returnFalse);},5000);}};onMessage(messaging,function(payload){var _payload$notification,_payload$notification2;if((_payload$notification=payload.notification)!==null&&_payload$notification!==void 0&&_payload$notification.body&&(_payload$notification2=payload.notification)!==null&&_payload$notification2!==void 0&&_payload$notification2.title){var _payload$notification3,_payload$notification4;var body=JSON.parse((_payload$notification3=payload.notification)===null||_payload$notification3===void 0?void 0:_payload$notification3.body);var newInfo={id:body===null||body===void 0?void 0:body.post_id,emoji:body===null||body===void 0?void 0:body.emoji_no,title:(_payload$notification4=payload.notification)===null||_payload$notification4===void 0?void 0:_payload$notification4.title};setInfo(newInfo);}});useEffect(function(){if(info!==initialInfo){setOpen(returnTrue);}},[info]);useEffect(function(){return changeOpenState;},[open]);return/*#__PURE__*/_jsx(_Fragment,{children:open?/*#__PURE__*/_jsx(\"div\",{id:\"foreground\",children:/*#__PURE__*/_jsx(MyNotification,{item:info})}):null});}export default InitMessage;","map":{"version":3,"names":["getMessaging","onMessage","app","returnTrue","MyNotification","useEffect","useState","returnFalse","InitMessage","messaging","initialInfo","id","title","emoji","info","setInfo","open","setOpen","changeOpenState","setInterval","payload","notification","body","JSON","parse","newInfo","post_id","emoji_no"],"sources":["C:/Users/Administrator/Desktop/S07P31C209/frontend/src/apis/notifications/foregroundMessaging.tsx"],"sourcesContent":["import {getMessaging, onMessage} from 'firebase/messaging';\r\nimport app from '@apis/notifications/firebaseConfig';\r\nimport {returnTrue} from '@/components/common/commonFunc';\r\nimport MyNotification from '@individual/MyNotification';\r\nimport {useEffect, useState} from 'react';\r\nimport {returnFalse} from '@common/commonFunc';\r\n\r\nfunction InitMessage() {\r\n  const messaging = getMessaging(app);\r\n  const initialInfo = {id: 0, title: '', emoji: 0};\r\n  const [info, setInfo] = useState(initialInfo);\r\n  const [open, setOpen] = useState(false);\r\n  const changeOpenState = () => {\r\n    if (open) {\r\n      setInterval(() => {\r\n        setOpen(returnFalse);\r\n      }, 5000);\r\n    }\r\n  };\r\n\r\n  onMessage(messaging, payload => {\r\n    if (payload.notification?.body && payload.notification?.title) {\r\n      const body = JSON.parse(payload.notification?.body);\r\n      const newInfo = {\r\n        id: body?.post_id,\r\n        emoji: body?.emoji_no,\r\n        title: payload.notification?.title,\r\n      };\r\n      setInfo(newInfo);\r\n    }\r\n  });\r\n  useEffect(() => {\r\n    if (info !== initialInfo) {\r\n      setOpen(returnTrue);\r\n    }\r\n  }, [info]);\r\n\r\n  useEffect(() => changeOpenState, [open]);\r\n\r\n  return (\r\n    <>\r\n      {open ? (\r\n        <div id=\"foreground\">\r\n          <MyNotification item={info} />\r\n        </div>\r\n      ) : null}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default InitMessage;\r\n"],"mappings":"wIAAA,OAAQA,YAAY,CAAEC,SAAS,KAAO,oBAAoB,CAC1D,MAAOC,IAAG,KAAM,oCAAoC,CACpD,OAAQC,UAAU,KAAO,gCAAgC,CACzD,MAAOC,eAAc,KAAM,4BAA4B,CACvD,OAAQC,SAAS,CAAEC,QAAQ,KAAO,OAAO,CACzC,OAAQC,WAAW,KAAO,oBAAoB,CAAC,gGAE/C,QAASC,YAAW,EAAG,CACrB,GAAMC,UAAS,CAAGT,YAAY,CAACE,GAAG,CAAC,CACnC,GAAMQ,YAAW,CAAG,CAACC,EAAE,CAAE,CAAC,CAAEC,KAAK,CAAE,EAAE,CAAEC,KAAK,CAAE,CAAC,CAAC,CAChD,cAAwBP,QAAQ,CAACI,WAAW,CAAC,wCAAtCI,IAAI,eAAEC,OAAO,eACpB,eAAwBT,QAAQ,CAAC,KAAK,CAAC,yCAAhCU,IAAI,eAAEC,OAAO,eACpB,GAAMC,gBAAe,CAAG,QAAlBA,gBAAe,EAAS,CAC5B,GAAIF,IAAI,CAAE,CACRG,WAAW,CAAC,UAAM,CAChBF,OAAO,CAACV,WAAW,CAAC,CACtB,CAAC,CAAE,IAAI,CAAC,CACV,CACF,CAAC,CAEDN,SAAS,CAACQ,SAAS,CAAE,SAAAW,OAAO,CAAI,kDAC9B,GAAI,uBAAAA,OAAO,CAACC,YAAY,0CAApB,sBAAsBC,IAAI,0BAAIF,OAAO,CAACC,YAAY,2CAApB,uBAAsBT,KAAK,CAAE,mDAC7D,GAAMU,KAAI,CAAGC,IAAI,CAACC,KAAK,yBAACJ,OAAO,CAACC,YAAY,iDAApB,uBAAsBC,IAAI,CAAC,CACnD,GAAMG,QAAO,CAAG,CACdd,EAAE,CAAEW,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEI,OAAO,CACjBb,KAAK,CAAES,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEK,QAAQ,CACrBf,KAAK,yBAAEQ,OAAO,CAACC,YAAY,iDAApB,uBAAsBT,KAC/B,CAAC,CACDG,OAAO,CAACU,OAAO,CAAC,CAClB,CACF,CAAC,CAAC,CACFpB,SAAS,CAAC,UAAM,CACd,GAAIS,IAAI,GAAKJ,WAAW,CAAE,CACxBO,OAAO,CAACd,UAAU,CAAC,CACrB,CACF,CAAC,CAAE,CAACW,IAAI,CAAC,CAAC,CAEVT,SAAS,CAAC,iBAAMa,gBAAe,GAAE,CAACF,IAAI,CAAC,CAAC,CAExC,mBACE,yBACGA,IAAI,cACH,YAAK,EAAE,CAAC,YAAY,uBAClB,KAAC,cAAc,EAAC,IAAI,CAAEF,IAAK,EAAG,EAC1B,CACJ,IAAI,EACP,CAEP,CAEA,cAAeN,YAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}