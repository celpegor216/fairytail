{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\S07P31C209\\\\frontend\\\\src\\\\components\\\\messageDetail\\\\Report.tsx\",\n  _s = $RefreshSig$();\n// ** 신고 모달\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport '@common/Common.scss';\nimport Alert from '@common/Alert';\nimport { returnTrue, returnFalse, currentUser } from '@common/commonFunc';\nimport SelectBox from '@common/SelectBox';\nimport { reportMessage } from '@apis/messageDetail/detailFunc';\nimport { intro } from '@apis/router';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Report(_ref) {\n  _s();\n  let {\n    onCancel,\n    open,\n    type,\n    messageId\n  } = _ref;\n  // 선택한 신고 유형\n  const [reportType, setReportType] = useState(-1);\n  const [reportContent, setReportContent] = useState('');\n  const [info, setInfo] = useState({\n    title: '',\n    message: ''\n  });\n  const reportRef = useRef(null);\n\n  // 모달 바깥을 클릭 시 모달 닫힘\n  useEffect(() => {\n    window.addEventListener('mousedown', _ref2 => {\n      let {\n        target\n      } = _ref2;\n      if (reportRef.current && !reportRef.current.contains(target)) {\n        setReportType(-1);\n        onCancel();\n        setReportContent(() => '');\n      }\n    });\n  });\n\n  // 신고 접수 여부\n  const [reported, setReported] = useState(false);\n\n  // 로그인된 사용자인지 판별\n  const navigate = useNavigate();\n  const userId = currentUser();\n  useEffect(() => {\n    if (userId === -1) {\n      navigate(intro());\n    }\n  }, []);\n\n  // 백에 신고 요청\n  const reportedAlert = e => {\n    const data = {\n      content: reportContent,\n      type: reportType,\n      postId: messageId,\n      userId: userId\n    };\n    reportMessage(type, data).then(res => {\n      const newInfo = {\n        title: '신고 확인',\n        message: res.message\n      };\n      setInfo(() => newInfo);\n      setReported(returnTrue);\n    }).catch(() => {\n      const newInfo = {\n        title: '신고 확인',\n        message: '오류가 발생했습니다.'\n      };\n      setInfo(() => newInfo);\n      setReported(returnFalse);\n    }).finally(() => {\n      setReportContent(() => '');\n      setReportType(-1);\n    });\n  };\n\n  // 신고 내용 변경\n  const changeContent = e => {\n    setReportContent(() => e.target.value);\n  };\n\n  // 신고 확인 창 닫기\n  const closeAlert = () => {\n    setReported(returnFalse);\n    onCancel();\n  };\n\n  // 신고 창 닫기\n  const closeReport = () => {\n    setReportContent(() => '');\n    onCancel();\n    setReportType(-1);\n  };\n\n  // 신고 유형\n  const options = ['저작권 위반', '개인정보 침해', '부적절한 내용', '불법 홍보', '기타'];\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [open ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal\",\n      ref: reportRef,\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"modal-title\",\n        children: \"\\uC2E0\\uACE0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(SelectBox, {\n        reportType: reportType,\n        setReportType: setReportType,\n        options: options\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        className: \"modal-textarea\",\n        placeholder: \"\\uC2E0\\uACE0 \\uC0AC\\uC720\\uB97C \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694.\",\n        maxLength: 100,\n        rows: 8,\n        value: reportContent,\n        onChange: changeContent\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n        className: \"modal-footer\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: reportedAlert,\n          children: \"\\uD655\\uC778\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: closeReport,\n          children: \"\\uCDE8\\uC18C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }, this) : null, /*#__PURE__*/_jsxDEV(Alert, {\n      info: info,\n      open: reported,\n      onConfirmed: closeAlert\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(Report, \"bysbaXhwB1MYQfbb1KwGolQt0oc=\", false, function () {\n  return [useNavigate];\n});\n_c = Report;\nexport default Report;\nvar _c;\n$RefreshReg$(_c, \"Report\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useNavigate","Alert","returnTrue","returnFalse","currentUser","SelectBox","reportMessage","intro","Report","onCancel","open","type","messageId","reportType","setReportType","reportContent","setReportContent","info","setInfo","title","message","reportRef","window","addEventListener","target","current","contains","reported","setReported","navigate","userId","reportedAlert","e","data","content","postId","then","res","newInfo","catch","finally","changeContent","value","closeAlert","closeReport","options"],"sources":["C:/Users/Administrator/Desktop/S07P31C209/frontend/src/components/messageDetail/Report.tsx"],"sourcesContent":["// ** 신고 모달\r\n\r\nimport React, {useState, useEffect, useRef} from 'react';\r\nimport {useNavigate} from 'react-router-dom';\r\n\r\nimport '@common/Common.scss';\r\nimport Alert from '@common/Alert';\r\nimport {returnTrue, returnFalse, currentUser} from '@common/commonFunc';\r\nimport SelectBox from '@common/SelectBox';\r\nimport {reportMessage} from '@apis/messageDetail/detailFunc';\r\nimport {intro} from '@apis/router';\r\n\r\ninterface ReportProps {\r\n  open: boolean;\r\n  onCancel: () => void;\r\n  type: string;\r\n  messageId: number;\r\n}\r\n\r\nfunction Report({onCancel, open, type, messageId}: ReportProps) {\r\n  // 선택한 신고 유형\r\n  const [reportType, setReportType] = useState(-1);\r\n  const [reportContent, setReportContent] = useState('');\r\n  const [info, setInfo] = useState({title: '', message: ''});\r\n\r\n  const reportRef = useRef<HTMLDivElement>(null);\r\n\r\n  // 모달 바깥을 클릭 시 모달 닫힘\r\n  useEffect(() => {\r\n    window.addEventListener('mousedown', ({target}) => {\r\n      if (reportRef.current && !reportRef.current.contains(target as Node)) {\r\n        setReportType(-1);\r\n        onCancel();\r\n        setReportContent(() => '');\r\n      }\r\n    });\r\n  });\r\n\r\n  // 신고 접수 여부\r\n  const [reported, setReported] = useState(false);\r\n\r\n  // 로그인된 사용자인지 판별\r\n  const navigate = useNavigate();\r\n  const userId = currentUser();\r\n  useEffect(() => {\r\n    if (userId === -1) {\r\n      navigate(intro());\r\n    }\r\n  }, []);\r\n\r\n  // 백에 신고 요청\r\n  const reportedAlert = (e: React.MouseEvent<HTMLButtonElement>) => {\r\n    const data = {\r\n      content: reportContent,\r\n      type: reportType,\r\n      postId: messageId,\r\n      userId: userId,\r\n    };\r\n    reportMessage(type, data)\r\n      .then((res: any) => {\r\n        const newInfo = {title: '신고 확인', message: res.message};\r\n        setInfo(() => newInfo);\r\n        setReported(returnTrue);\r\n      })\r\n      .catch(() => {\r\n        const newInfo = {title: '신고 확인', message: '오류가 발생했습니다.'};\r\n        setInfo(() => newInfo);\r\n        setReported(returnFalse);\r\n      })\r\n      .finally(() => {\r\n        setReportContent(() => '');\r\n        setReportType(-1);\r\n      });\r\n  };\r\n\r\n  // 신고 내용 변경\r\n  const changeContent = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n    setReportContent(() => e.target.value);\r\n  };\r\n\r\n  // 신고 확인 창 닫기\r\n  const closeAlert = () => {\r\n    setReported(returnFalse);\r\n    onCancel();\r\n  };\r\n\r\n  // 신고 창 닫기\r\n  const closeReport = () => {\r\n    setReportContent(() => '');\r\n    onCancel();\r\n    setReportType(-1);\r\n  };\r\n\r\n  // 신고 유형\r\n  const options = [\r\n    '저작권 위반',\r\n    '개인정보 침해',\r\n    '부적절한 내용',\r\n    '불법 홍보',\r\n    '기타',\r\n  ];\r\n\r\n  return (\r\n    <>\r\n      {open ? (\r\n        <div className=\"modal\" ref={reportRef}>\r\n          <p className=\"modal-title\">신고</p>\r\n\r\n          <SelectBox\r\n            reportType={reportType}\r\n            setReportType={setReportType}\r\n            options={options}\r\n          />\r\n\r\n          <textarea\r\n            className=\"modal-textarea\"\r\n            placeholder=\"신고 사유를 입력해주세요.\"\r\n            maxLength={100}\r\n            rows={8}\r\n            value={reportContent}\r\n            onChange={changeContent}\r\n          />\r\n          <footer className=\"modal-footer\">\r\n            <button className=\"btn\" onClick={reportedAlert}>\r\n              확인\r\n            </button>\r\n            <button className=\"btn\" onClick={closeReport}>\r\n              취소\r\n            </button>\r\n          </footer>\r\n        </div>\r\n      ) : null}\r\n      <Alert info={info} open={reported} onConfirmed={closeAlert} />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Report;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}